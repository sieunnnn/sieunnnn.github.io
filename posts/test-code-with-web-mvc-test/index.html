<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="ko" data-mode="light">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="단위테스트 작성하기 with @WebMvcTest" />
<meta name="author" content="김자바" />
<meta property="og:locale" content="ko" />
<meta name="description" content="Spring Rest Docs 를 작성하려면 테스트 코드를 작성할 줄 알아야합니다. 따라서 이곳에서는 기본적인 테스트 코드 작성법을 기술합니다." />
<meta property="og:description" content="Spring Rest Docs 를 작성하려면 테스트 코드를 작성할 줄 알아야합니다. 따라서 이곳에서는 기본적인 테스트 코드 작성법을 기술합니다." />
<link rel="canonical" href="https://sieunnnn.github.io/posts/test-code-with-web-mvc-test/" />
<meta property="og:url" content="https://sieunnnn.github.io/posts/test-code-with-web-mvc-test/" />
<meta property="og:site_name" content="김자바의 개발일지" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-04-21T12:33:00+09:00" />
<meta property="og:image" content="https://sieunnnn.github.io/assets/img/profile.jpg" /><meta name="twitter:card" content="summary_large_image" />
      <meta property="twitter:image" content="https://sieunnnn.github.io/assets/img/profile.jpg" />
<meta property="twitter:title" content="단위테스트 작성하기 with @WebMvcTest" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"김자바"},"dateModified":"2024-04-21T12:33:00+09:00","datePublished":"2024-04-21T12:33:00+09:00","description":"Spring Rest Docs 를 작성하려면 테스트 코드를 작성할 줄 알아야합니다. 따라서 이곳에서는 기본적인 테스트 코드 작성법을 기술합니다.","headline":"단위테스트 작성하기 with @WebMvcTest","mainEntityOfPage":{"@type":"WebPage","@id":"https://sieunnnn.github.io/posts/test-code-with-web-mvc-test/"},"url":"https://sieunnnn.github.io/posts/test-code-with-web-mvc-test/"}</script>
<!-- End Jekyll SEO tag -->


  <title>단위테스트 작성하기 with @WebMvcTest | 김자바의 개발일지
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="김자바의 개발일지">
<meta name="application-name" content="김자바의 개발일지">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js,npm/mermaid@11.4.0/dist/mermaid.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script async src="/assets/js/data/mathjax.js"></script>
  <script async src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script>


<!-- Pageviews -->

  

  



  <!-- Web Analytics -->
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DZNCWY7GW2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DZNCWY7GW2');
</script>


<!--  -->

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar"><img src="/assets/img/profile.jpg" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">김자바의 개발일지</a>
    <p class="site-subtitle mb-0">🚧 노션 블로그 이전중 🚧</p>
    <a href="https://hits.seeyoufarm.com"><img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fsieunnnn.github.io&count_bg=%23575757&title_bg=%23010081&icon=&icon_color=%23E7E7E7&title=%F0%9F%92%BB+%F0%9F%92%A5%E4%B8%89%F0%9F%94%AB%28+%CB%99%EA%92%B3%E2%80%8B%CB%99+%29&edge_flat=false" style="margin-top: 15px"/></a>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <img src="https://sieunnnn.github.io/assets/img/icons/home.png" style="width: 24px; height: 24px; margin-right: 20px"/>
          <span style="font-size: 1.02rem !important;">HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        
        <li class="nav-item">
        <a href="/categories/" class="nav-link">
          
          <img src="https://sieunnnn.github.io/assets/img/icons/categories.png" style="width: 24px; height: 24px; margin-right: 20px"/>
          
          <span style="font-size: 1.02rem !important;">CATEGORIES</span>
        </a>
        </li>
        
      
        
        <li class="nav-item">
        <a href="/tags/" class="nav-link">
          
          <img src="https://sieunnnn.github.io/assets/img/icons/tags.png" style="width: 24px; height: 24px; margin-right: 20px"/>
          
          <span style="font-size: 1.02rem !important;">TAGS</span>
        </a>
        </li>
        
      
        
      
        
        <li class="nav-item">
        <a href="/about/" class="nav-link">
          
          <img src="https://sieunnnn.github.io/assets/img/icons/about.png" style="width: 24px; height: 24px; margin-right: 20px"/>
          
          <span style="font-size: 1.02rem !important;">ABOUT</span>
        </a>
        </li>
        
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap" style="padding: 0 0 15px 0 !important; width:100%; display:flex !important; flex-direction: row !important;  justify-content: center !important; justify-items: center !important; align-content: center !important; background: none !important; box-shadow: none !important; border: none !important;">
    
      
        

      
        <a
          href="https://github.com/sieunnnn"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        style="display: block; margin: 0 auto; background: none !important; box-shadow: none !important; border: none !important; object-fit: contain;"
        >
          
          <img src="https://sieunnnn.github.io/assets/img/icons/github.png" style="width: 26px; height: 26px;" />
        </a>
      
    
        

      
        <a
          href="mailto:wldsmtldsm65@gmail.com"
          aria-label="email"
          

          

          

          
        style="display: block; margin: 0 auto; background: none !important; box-shadow: none !important; border: none !important; object-fit: contain;"
        >
          
          <img src="https://sieunnnn.github.io/assets/img/icons/email.png" style="width: 26px; height: 26px;" />
        </a>
      
    
        

      
        <a
          href="https://www.linkedin.com/in/"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        style="display: block; margin: 0 auto; background: none !important; box-shadow: none !important; border: none !important; object-fit: contain;"
        >
          
          <img src="https://sieunnnn.github.io/assets/img/icons/linkedin.png" style="width: 26px; height: 26px;" />
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>단위테스트 작성하기 with @WebMvcTest</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw" style="color: whitesmoke !important; font-size: 14px; margin-bottom: 7px"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

<!--    <button type="button" id="search-trigger" class="btn btn-link">-->
<!--      <i class="fas fa-search fa-fw"></i>-->
<!--    </button>-->

<!--    <search id="search" class="align-items-center ms-3 ms-lg-0">-->
<!--      <i class="fas fa-search fa-fw"></i>-->
<!--      <input-->
<!--        class="form-control"-->
<!--        id="search-input"-->
<!--        type="search"-->
<!--        aria-label="search"-->
<!--        autocomplete="off"-->
<!--        placeholder="Search..."-->
<!--      >-->
<!--    </search>-->
<!--    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">-->
<!--Cancel-->
<!--    </button>-->
  </div>
</header>


        <div class="row flex-grow-1" style="padding: 30px 20px 0 20px">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->


  
  

  
    
      

      
        
        
<!--        -->
      

      

      
    
  
    
      

      
        
        
<!--        -->
      

      

      
    
  
    
      

      
        
        
<!--        -->
      

      

      
    
  
    
      

      
        
        
<!--        -->
      

      

      
    
  
    
      

      
        
        
<!--        -->
      

      

      
    
  
    
      

      
        
        
<!--        -->
      

      

      
    
  
    
      

      
        
        
<!--        -->
      

      

      
    
  
    
      

      
        
        
<!--        -->
      

      

      
    
  
    
      

      
        
        
<!--        -->
      

      

      
    
  
    
      

      
        
        
<!--        -->
      

      

      
    
  
    
      

      
        
        
<!--        -->
      

      

      
    
  
    
      

      
        
        
<!--        -->
      

      

      
    
  
    
      

      
        
        
<!--        -->
      

      

      
    
  
    
      

    
  

  


<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  




<!-- return -->







  
    
      
        
  
        
        
      




<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>단위테스트 작성하기 with @WebMvcTest</h1>
    
      <p class="post-desc fw-light mb-4">Spring Rest Docs 를 작성하려면 테스트 코드를 작성할 줄 알아야합니다. 따라서 이곳에서는 기본적인 테스트 코드 작성법을 기술합니다.</p>
    

    <div class="post-meta text-muted d-flex justify-content-between">
      <!-- published date -->
      <span style="margin-right: 10px">
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1713670380"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Apr 21, 2024
</time>

      </span>

      <!-- lastmod date -->
      

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="4941 words"
>
  <em>27 min</em> read</span>

        </div>
  </header>

<!--  -->
<!--    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">-->
<!--      <span class="label text-truncate">단위테스트 작성하기 with @WebMvcTest</span>-->
<!--      <button type="button" class="toc-trigger btn me-1">-->
<!--        <i class="fa-solid fa-list-ul fa-fw"></i>-->
<!--      </button>-->
<!--    </div>-->

<!--    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">-->
<!--      <span class="label ps-2 pe-1">Contents</span>-->
<!--      <i class="fa-solid fa-angle-right fa-fw"></i>-->
<!--    </button>-->

<!--    <dialog id="toc-popup" class="p-0">-->
<!--      <div class="header d-flex flex-row align-items-center justify-content-between">-->
<!--        <div class="label text-truncate py-2 ms-4">단위테스트 작성하기 with @WebMvcTest</div>-->
<!--        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">-->
<!--          <i class="fas fa-close"></i>-->
<!--        </button>-->
<!--      </div>-->
<!--      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>-->
<!--    </dialog>-->
<!--  -->

  <div class="content">
    <h2 id="1-단위-테스트-와-통합-테스트"><span class="me-2">1. 단위 테스트 와 통합 테스트</span><a href="#1-단위-테스트-와-통합-테스트" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h2>

<h3 id="11-화이트-박스와-블랙-박스-검사"><span class="me-2">1.1. 화이트 박스와 블랙 박스 검사</span><a href="#11-화이트-박스와-블랙-박스-검사" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h3>

<p>화이트 박스 검사는 내부 소스 코드를 테스트하는 기법입니다. 반면 블랙 박스 검사의 경우 내부를 보지 않고 입출력을 확인하여 기능이 잘 돌아가는지 확인합니다. 때문에 화이트 박스 테스는 주로 <strong>개발자</strong>가 합니다. 코드를 기반으로 테스트하기 때문에 동작을 추적할 수 있고, 실행 과정을 살펴보며 불필요한 코드가 있는지 확인할 수 있기 때문이죠. 반면 블랙박스 검사는 내부 구조나 작동 원리를 모르는 상태에서 동작을 검사합니다. 때문에 대외적으로 공개된 사항들을 기반으로 테스트를 하고, 요구 사항 등에 초점을 맞춰 검사가 이뤄집니다. 때문에 <strong>테스터</strong>들이 주로 해당 기법을 사용합니다.</p>

<h3 id="12-단위-테스트"><span class="me-2">1.2. 단위 테스트</span><a href="#12-단위-테스트" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h3>

<p>제가 진행하고 있는 프로젝트에는 많은 기능이 있습니다. 회원가입, 로그인, 유저 정보 변경 등… 다양한 기능이 있는데, 이 중 회원가입과 같은 특정 기능만 테스트 해보는것이 단위 테스트 입니다.</p>

<p>테스트 코드를 작성하여 동작 해보고 이상 유무를 판별합니다. 모듈 한개를 테스트 하기 때문에 모듈 테스트라고 하며, 화이트 박스 테스트 기법을 주로 사용 합니다. 외부 서비스(DB) 와 연동이 되면 안되기 때문에 가짜 객체를 만들어 테스트를 수행합니다.</p>

<h3 id="13-통합-테스트"><span class="me-2">1.3. 통합 테스트</span><a href="#13-통합-테스트" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h3>

<p>통합 테스트의 경우 단위 테스트를 마친 모듈을 합치는 과정에서 발생할 수 있는 오류를 찾는 테스트 입니다. 규모가 커질수록 여러 모듈이 유기적인 관계를 맺고 있기 때문에 이러한 모듈을 결합한 형태로 테스트를 수행해야 합니다. 이때 모듈 간의 상호작용이 정상적으로 수행 되는가? 를 위주로 봅니다. 즉, 모듈이 올바르게 맞물려 동작하고 있는지, 외부 서비스와의 연동에서 오류가 나타나지 않는지 등을 확인 합니다.</p>

<p>통합 테스트의 경우 모듈 통합을 한꺼번에 하는 빅뱅 테스트와 점진적으로 모듈 통합을 하는 기법 두가지가 존재합니다. 전자의 경우는 소규모 프로그램이나 프로그램의 일부를 대상으로 합니다. 규모가 커지면 원인을 찾기 힘들다는 단점이 존재하죠. 하지만 절차가 간단하고 쉽다는 장점이 있습니다.</p>

<p>후자의 경우는 점진적으로 모듈 통합을 하며 테스트를 수행하는 경우 오류가 발생했을 때 원인을 찾기 쉽습니다. 종류로는 하향식 기법과 상향식 기법이 있습니다. 하향식 기법의 경우 최상위 모듈 부터 하위 모듈(stub) 을 통합하는 방식입니다. 일반적으로 상위 모듈은 시스템 전체의 흐름을 관장하고, 하위 모듈은 각 기능을 구현합니다. 때문에 하향식 기법을 사용하면 오류를 일찍 발견하기 쉽습니다. 반면 상향식 기법의 경우 최하위 모듈 부터 테스트를 시작합니다. 최하위 모듈을 충분히 테스트 할 수 있다는 것이 장점이지만 상위 모듈(test driver) 에 문제가 생기면 하위 모듈을 다시 테스트 해야 합니다.</p>

<p><br />
<br /></p>

<h2 id="2-webmvctest-와-springboottest"><span class="me-2">2. @WebMvcTest 와 @SpringBootTest</span><a href="#2-webmvctest-와-springboottest" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h2>

<blockquote>
  <p>🫘 @WebMvcTest 와 @SpringBootTest 는 빈의 등록 범위와 MockMvc 를 주입 받는 것에 차이가 존재합니다.</p>
</blockquote>

<h3 id="21-mock"><span class="me-2">2.1. Mock</span><a href="#21-mock" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h3>

<p>가짜 객체를 만들어서 테스트하는 기술입니다. 이 과정에서 만들어진 가짜 객체를 MockMvc 라고 합니다. 이는 @Autowired 로 주입받아서 사용할 수 있습니다.</p>

<h3 id="22-springboottest"><span class="me-2">2.2. @SpringBootTest</span><a href="#22-springboottest" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h3>

<p>@SpringBootTest 의 경우 프로젝트 내부에 있는 스프링 빈을 모두 등록합니다. 때문에 테스트가 느리지만 실제 환경과 가장 유사하게 테스트가 가능합니다.</p>

<h4 id="221-springboottest-에서-mockmvc-주입하기"><span class="me-2">2.2.1. @SpringBootTest 에서 MockMvc 주입하기</span><a href="#221-springboottest-에서-mockmvc-주입하기" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h4>

<p>@SpringBootTest 는 MockMvc 를 빈으로 등록시키지 않습니다. 따라서 @AutoConfigureMockMvc 를 사용합니다.</p>

<div class="language-java highlighter-rouge"><div class="code-header" style="color: black !important;"">
        <span data-label-text="Java" style="color: black !important;"><img src="/assets/img/icons/code.png" width="21px" style="margin-right: 5px"/></span>
      <button aria-label="copy" data-title-succeed="Copied!"><img src="/assets/img/icons/copy.png" width="19px" style="margin-bottom: 4px"/></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nd">@SpringBootTess</span>
<span class="kd">class</span> <span class="nc">SpringBootTest</span> <span class="o">{</span>
		<span class="nd">@Autowired</span>
		<span class="nc">MockMvc</span> <span class="n">mockMvc</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="23-webmvctest"><span class="me-2">2.3. @WebMvcTest</span><a href="#23-webmvctest" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h3>

<p>컨트롤러의 역할만을 테스트 합니다.(<em>슬라이스 테스트</em>) 때문에 Web Layer 에 해당하는 빈만 빠르게 생성합니다. 필요한 경우 직접 빈을 추가 할 수 있으며, 테스트 속도가 빠르다는 장점이 있습니다. 하지만 Mock 객체를 사용하기 때문에 실제 동작과 차이가 존재하며, Mocking 메서드의 변경이 일어나면 수정이 필요합니다.</p>

<h4 id="231-webmvctest-에서-mockmvc-주입하기"><span class="me-2">2.3.1. @WebMvcTest 에서 MockMvc 주입하기</span><a href="#231-webmvctest-에서-mockmvc-주입하기" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h4>

<p>@WebMvcTest 는 MockMvc 를 빈으로 등록 합니다. 따라서 아래와 같이 선언만 해주면 됩니다.</p>

<div class="language-java highlighter-rouge"><div class="code-header" style="color: black !important;"">
        <span data-label-text="Java" style="color: black !important;"><img src="/assets/img/icons/code.png" width="21px" style="margin-right: 5px"/></span>
      <button aria-label="copy" data-title-succeed="Copied!"><img src="/assets/img/icons/copy.png" width="19px" style="margin-bottom: 4px"/></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nd">@WebMvcTest</span>
<span class="kd">class</span> <span class="nc">WebMvcTest</span> <span class="o">{</span>
		<span class="nd">@Autowired</span>
		<span class="nc">MockMvc</span> <span class="n">mockMvc</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h4 id="232-webmvctest-가-등록하는-빈의-종류"><span class="me-2">2.3.2. @WebMvcTest 가 등록하는 빈의 종류</span><a href="#232-webmvctest-가-등록하는-빈의-종류" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h4>

<ul>
  <li>@Controller, @RestController</li>
  <li>@ControllerAdvice, @RestControllerAdvice</li>
  <li>@JsonComponent</li>
  <li>Filter</li>
  <li>WebMvcConfigurer</li>
  <li>HandlerMethodArgumentResolver</li>
</ul>

<h4 id="232-repository-와-service-는요"><span class="me-2">2.3.2. Repository 와 Service 는요?</span><a href="#232-repository-와-service-는요" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h4>

<p>@Autowired 가 아닌 @MockBean 을 사용하여 Mock 객체에 빈으로 등록해야 합니다.</p>

<p><br />
<br /></p>

<h2 id="3-무엇-을-이용하여-어떤-테스트를-할까-"><span class="me-2">3. 무엇 **을 이용하여 어떤 테스트를 할까? 🤔</span><a href="#3-무엇-을-이용하여-어떤-테스트를-할까-" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h2>

<h3 id="31-테스트의-목적"><span class="me-2">3.1. 테스트의 목적</span><a href="#31-테스트의-목적" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h3>

<p>회원가입, 로그인이 제대로 수행 되는지 확인하고 테스트 결과를 사용하여 Spring Rest Docs 를 만들기 위해 테스트를 수행하려 합니다.</p>

<h3 id="32-springboottest-와-webmvctest"><span class="me-2">3.2. @SpringBootTest 와 @WebMvcTest</span><a href="#32-springboottest-와-webmvctest" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h3>

<p>회원 가입과 로그인의 Controller 만 테스트를 수행해도 충분하기 때문에 @WebMvcTest 를 사용하기로 했습니다. 회원 가입에서 주로 확인할 것은 제약사항으로 걸어두었던 패턴 위반시에 알맞은 오류를 반환 하는지의 여부 입니다. 이는 외부 서비스와의 연동이 필요 없고 가짜 객체를 만들어 수행하는 것만으로도 충분하다는 판단을 했습니다.</p>

<p>로그인의 경우 알맞은 값을 넣을 때만 생각했을때는 @WebMvcTest 만으로도 충분하다 생각했습니다. 하지만 존재하지 않는 이메일로 로그인을 하거나 이메일은 맞지만 비밀번호를 잘못 입력 하였을 때가 문제였습니다. 이를 테스트 하기 위해서는 외부 서비스 즉, 데이터 베이스와 연결하여 해당 데이터가 있는지 존재 유무를 판단해야 합니다. 따라서 @SpringBootTest 를 사용하기로 하였습니다. 데이터 베이스는 간단하게 H2 를 사용하기로 하였습니다.</p>

<h3 id="33-결론"><span class="me-2">3.3. 결론</span><a href="#33-결론" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h3>

<p>결론적으로 아래와 같이 테스트를 진행하기로 하였습니다.</p>

<h4 id="331-회원가입"><span class="me-2">3.3.1. 회원가입</span><a href="#331-회원가입" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h4>

<ul>
  <li>알맞은 값을 이용한 회원가입</li>
  <li>이메일 양식이 맞지 않는 경우 알맞은 예외를 반환하는가?</li>
  <li>이미 존재하는 이메일 입력시 알맞은 예외를 반환하는가?</li>
  <li>조건에 맞지 않는 닉네임 입력시 알맞은 예외를 반환하는가?</li>
  <li>조건에 맞지 않는 비밀번호 입력 시 알맞은 예외를 반환하는가?</li>
</ul>

<h4 id="332-로그인"><span class="me-2">3.3.2. 로그인</span><a href="#332-로그인" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h4>

<ul>
  <li>알맞은 값을 이용한 로그인</li>
  <li>존재하지 않는 이메일을 입력할 경우 알맞은 예외를 반환하는가?</li>
  <li>이메일은 맞지만 비밀번호를 잘못 입력한 경우 알맞은 예외를 반환하는가?</li>
</ul>

<p><br />
<br /></p>

<h2 id="4-spring-security-로-인한-401--403-상태코드-해결하기"><span class="me-2">4. Spring Security 로 인한 401 / 403 상태코드 해결하기</span><a href="#4-spring-security-로-인한-401--403-상태코드-해결하기" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h2>

<p>Spring security 를 사용하는 application 의 테스트로 @WebMvcTest 사용시 401, 403 상태코드가 반환됩니다. 정상적으로 테스트코드를 다 작성한것 같은데도 불구하고 말이죠. 왜 그런 걸까요? 🤔</p>

<p>이전에 @WebMvcTest 는 컨트롤러 테스트를 위해 필요한 빈들만 등록합니다. 때문에 직접 custom 한 시큐리티 configuration 이 등록되지 않습니다. 따라서 custom 한 AuthenticationEntryPoint 도 가져올 수 없어요! 대신 spring security 가 자동으로 구성하는 configuration 을 가져옵니다.</p>

<p>따라서 인증된 객체를 넘겨주지 않는 경우 401 이 반환 되며, 인증된 유저지만 권한이 맞지 않아 인가과정을 거칠 수 없는 경우 403 을 반환 합니다.</p>

<h3 id="41-401-상태코드-해결하기"><span class="me-2">4.1. 401 상태코드 해결하기</span><a href="#41-401-상태코드-해결하기" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h3>

<div class="language-java highlighter-rouge"><div class="code-header" style="color: black !important;"">
        <span data-label-text="Java" style="color: black !important;"><img src="/assets/img/icons/code.png" width="21px" style="margin-right: 5px"/></span>
      <button aria-label="copy" data-title-succeed="Copied!"><img src="/assets/img/icons/copy.png" width="19px" style="margin-bottom: 4px"/></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nd">@WebMvcTest</span><span class="o">(</span><span class="nc">UserController</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@WithMockUser</span> <span class="c1">// withMockUser 사용하여 인증된 사용자를 넣어준다.</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="42-403-상태코드-해결하기"><span class="me-2">4.2. 403 상태코드 해결하기</span><a href="#42-403-상태코드-해결하기" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h3>

<p>위와 같이 인증된 사용자를 넣어도 csrf 문제를 해결해주지 않으면 계속 403 오류가 발생합니다. 세션/쿠키를 사용하여 상태 유지를 하는 경우 csrf 를 사용하는 것이 일반적이지만 rest api 의 경우 요청이 세션에 의존하지 않기 때문에 보통 csrf 기능을 disable 처리 합니다. 하지만, 기본으로 제공되는 설정에서는 아니므로 아래와 같이 csrf 기능을 사용해야 합니다.</p>

<div class="language-java highlighter-rouge"><div class="code-header" style="color: black !important;"">
        <span data-label-text="Java" style="color: black !important;"><img src="/assets/img/icons/code.png" width="21px" style="margin-right: 5px"/></span>
      <button aria-label="copy" data-title-succeed="Copied!"><img src="/assets/img/icons/copy.png" width="19px" style="margin-bottom: 4px"/></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"회원 가입"</span><span class="o">)</span>
    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">signup</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">SignupRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SignupRequest</span><span class="o">(</span>
                <span class="s">"wldsmtldsm65@gmail.com"</span><span class="o">,</span>
                <span class="s">"123qwe!@#QWE"</span><span class="o">,</span>
                <span class="s">"시니"</span><span class="o">,</span>
                <span class="nc">LocalDate</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"1996-11-20"</span><span class="o">)</span>
        <span class="o">);</span>

        <span class="n">doNothing</span><span class="o">()</span>
                <span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">signupService</span><span class="o">)</span>
                <span class="o">.</span><span class="na">signup</span><span class="o">(</span><span class="n">any</span><span class="o">(</span><span class="nc">SignupRequest</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>

        <span class="n">mockMvc</span>
                <span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="s">"/api/v1/auth/signup"</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">with</span><span class="o">(</span><span class="n">csrf</span><span class="o">())</span>
                        <span class="o">.</span><span class="na">contentType</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
                        <span class="o">...</span>
</pre></td></tr></tbody></table></code></div></div>

<p><br />
<br /></p>

<h2 id="5-알맞은-요청으로-인한-상태코드-200"><span class="me-2">5. 알맞은 요청으로 인한 상태코드 200</span><a href="#5-알맞은-요청으로-인한-상태코드-200" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h2>

<h3 id="51-회원가입"><span class="me-2">5.1. 회원가입</span><a href="#51-회원가입" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h3>

<div class="language-java highlighter-rouge"><div class="code-header" style="color: black !important;"">
        <span data-label-text="Java" style="color: black !important;"><img src="/assets/img/icons/code.png" width="21px" style="margin-right: 5px"/></span>
      <button aria-label="copy" data-title-succeed="Copied!"><img src="/assets/img/icons/copy.png" width="19px" style="margin-bottom: 4px"/></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="rouge-code"><pre><span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"회원 가입"</span><span class="o">)</span>
    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">signup</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">SignupRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SignupRequest</span><span class="o">(</span>
                <span class="s">"wldsmtldsm65@gmail.com"</span><span class="o">,</span>
                <span class="s">"123qwe!@#QWE"</span><span class="o">,</span>
                <span class="s">"시니"</span><span class="o">,</span>
                <span class="nc">LocalDate</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"1996-11-20"</span><span class="o">)</span>
        <span class="o">);</span>

        <span class="n">doNothing</span><span class="o">()</span>
                <span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">signupService</span><span class="o">)</span>
                <span class="o">.</span><span class="na">signup</span><span class="o">(</span><span class="n">any</span><span class="o">(</span><span class="nc">SignupRequest</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>

        <span class="n">mockMvc</span>
                <span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="s">"/api/v1/auth/signup"</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">with</span><span class="o">(</span><span class="n">csrf</span><span class="o">())</span>
                        <span class="o">.</span><span class="na">contentType</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="n">objectMapper</span><span class="o">.</span><span class="na">writeValueAsString</span><span class="o">(</span><span class="n">request</span><span class="o">))</span>
                        <span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">())</span>
                <span class="o">.</span><span class="na">andDo</span><span class="o">(</span><span class="nc">MockMvcRestDocumentation</span><span class="o">.</span><span class="na">document</span><span class="o">(</span><span class="s">"signup"</span><span class="o">,</span>
                        <span class="nc">ApiDocumentUtil</span><span class="o">.</span><span class="na">getDocumentRequest</span><span class="o">(),</span>
                        <span class="nc">ApiDocumentUtil</span><span class="o">.</span><span class="na">getDocumentResponse</span><span class="o">(),</span>
                        <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">requestFields</span><span class="o">(</span>
                                <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">fieldWithPath</span><span class="o">(</span><span class="s">"email"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"이메일"</span><span class="o">),</span>
                                <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">fieldWithPath</span><span class="o">(</span><span class="s">"password"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"영어, 숫자, 특수 문자 포함 8 - 20 자리 비밀번호"</span><span class="o">),</span>
                                <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">fieldWithPath</span><span class="o">(</span><span class="s">"nickname"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"특수 문자를 포함 하지 않는 2-12 자 닉네임"</span><span class="o">),</span>
                                <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">fieldWithPath</span><span class="o">(</span><span class="s">"birthday"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"생년월일"</span><span class="o">)</span>

                        <span class="o">)));</span>

        <span class="n">verify</span><span class="o">(</span><span class="n">signupService</span><span class="o">,</span> <span class="n">times</span><span class="o">(</span><span class="mi">1</span><span class="o">)).</span><span class="na">signup</span><span class="o">(</span><span class="n">any</span><span class="o">(</span><span class="nc">SignupRequest</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
    <span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="52-로그인"><span class="me-2">5.2. 로그인</span><a href="#52-로그인" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h3>

<div class="language-java highlighter-rouge"><div class="code-header" style="color: black !important;"">
        <span data-label-text="Java" style="color: black !important;"><img src="/assets/img/icons/code.png" width="21px" style="margin-right: 5px"/></span>
      <button aria-label="copy" data-title-succeed="Copied!"><img src="/assets/img/icons/copy.png" width="19px" style="margin-bottom: 4px"/></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
</pre></td><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.planner.travel.user.login</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.ObjectMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.planner.travel.domain.user.controller.UserController</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.planner.travel.domain.user.dto.request.LoginRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.planner.travel.domain.user.service.LoginService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.planner.travel.domain.user.service.SignupService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.planner.travel.global.ApiDocumentUtil</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.planner.travel.global.jwt.token.TokenGenerator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.planner.travel.global.jwt.token.TokenType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.planner.travel.global.util.CookieUtil</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">jakarta.servlet.http.Cookie</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">jakarta.servlet.http.HttpServletResponse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DisplayName</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.test.autoconfigure.restdocs.AutoConfigureRestDocs</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.test.mock.mockito.MockBean</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.MediaType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.mock.web.MockHttpServletResponse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.restdocs.mockmvc.MockMvcRestDocumentation</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.restdocs.payload.PayloadDocumentation</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.test.context.support.WithMockUser</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.test.web.servlet.MockMvc</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">mockito</span><span class="o">.</span><span class="na">ArgumentMatchers</span><span class="o">.</span><span class="na">any</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">mockito</span><span class="o">.</span><span class="na">Mockito</span><span class="o">.*;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">headers</span><span class="o">.</span><span class="na">HeaderDocumentation</span><span class="o">.</span><span class="na">headerWithName</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">headers</span><span class="o">.</span><span class="na">HeaderDocumentation</span><span class="o">.</span><span class="na">responseHeaders</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">security</span><span class="o">.</span><span class="na">test</span><span class="o">.</span><span class="na">web</span><span class="o">.</span><span class="na">servlet</span><span class="o">.</span><span class="na">request</span><span class="o">.</span><span class="na">SecurityMockMvcRequestPostProcessors</span><span class="o">.</span><span class="na">csrf</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">test</span><span class="o">.</span><span class="na">web</span><span class="o">.</span><span class="na">servlet</span><span class="o">.</span><span class="na">request</span><span class="o">.</span><span class="na">MockMvcRequestBuilders</span><span class="o">.</span><span class="na">post</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">test</span><span class="o">.</span><span class="na">web</span><span class="o">.</span><span class="na">servlet</span><span class="o">.</span><span class="na">result</span><span class="o">.</span><span class="na">MockMvcResultMatchers</span><span class="o">.</span><span class="na">status</span><span class="o">;</span>

<span class="nd">@WebMvcTest</span><span class="o">(</span><span class="nc">UserController</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@AutoConfigureRestDocs</span>
<span class="nd">@WithMockUser</span><span class="o">(</span><span class="n">username</span><span class="o">=</span><span class="s">"wldsmtldsm65@gmail.com"</span><span class="o">,</span> <span class="n">roles</span><span class="o">={</span><span class="s">"USER"</span><span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LoginControllerTest</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">MockMvc</span> <span class="n">mockMvc</span><span class="o">;</span>

    <span class="nd">@MockBean</span>
    <span class="kd">private</span> <span class="nc">SignupService</span> <span class="n">signupService</span><span class="o">;</span>
    <span class="nd">@MockBean</span>
    <span class="kd">private</span> <span class="nc">LoginService</span> <span class="n">loginService</span><span class="o">;</span>
    <span class="nd">@MockBean</span>
    <span class="kd">private</span> <span class="nc">CookieUtil</span> <span class="n">cookieUtil</span><span class="o">;</span>
    <span class="nd">@MockBean</span>
    <span class="kd">private</span> <span class="nc">TokenGenerator</span> <span class="n">tokenGenerator</span><span class="o">;</span>

    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"로그인"</span><span class="o">)</span>
    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">login</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">LoginRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LoginRequest</span><span class="o">(</span><span class="s">"wldsmtldsm65@gmail.com"</span><span class="o">,</span> <span class="s">"123qwe!@#QWE"</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">fakeAccessToken</span> <span class="o">=</span> <span class="s">"Bearer valid_access_token"</span><span class="o">;</span>  <span class="c1">// 유효한 토큰으로 가정</span>
        <span class="nc">String</span> <span class="n">fakeRefreshToken</span> <span class="o">=</span> <span class="s">"valid_refresh_token"</span><span class="o">;</span>  <span class="c1">// 유효한 토큰으로 가정</span>

        <span class="n">when</span><span class="o">(</span><span class="n">tokenGenerator</span><span class="o">.</span><span class="na">generateToken</span><span class="o">(</span><span class="nc">TokenType</span><span class="o">.</span><span class="na">ACCESS</span><span class="o">,</span> <span class="s">"1"</span><span class="o">)).</span><span class="na">thenReturn</span><span class="o">(</span><span class="n">fakeAccessToken</span><span class="o">);</span>
        <span class="n">when</span><span class="o">(</span><span class="n">tokenGenerator</span><span class="o">.</span><span class="na">generateToken</span><span class="o">(</span><span class="nc">TokenType</span><span class="o">.</span><span class="na">REFRESH</span><span class="o">,</span> <span class="s">"1"</span><span class="o">)).</span><span class="na">thenReturn</span><span class="o">(</span><span class="n">fakeRefreshToken</span><span class="o">);</span>

        <span class="n">doAnswer</span><span class="o">(</span><span class="n">invocation</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="nc">HttpServletResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">invocation</span><span class="o">.</span><span class="na">getArgument</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
            <span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="n">fakeAccessToken</span><span class="o">);</span>

            <span class="nc">Cookie</span> <span class="n">cookie</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Cookie</span><span class="o">(</span><span class="s">"refreshToken"</span><span class="o">,</span> <span class="n">fakeRefreshToken</span><span class="o">);</span>
            <span class="n">cookie</span><span class="o">.</span><span class="na">setPath</span><span class="o">(</span><span class="s">"/"</span><span class="o">);</span>  <span class="c1">// 쿠키 경로 설정</span>
            <span class="n">cookie</span><span class="o">.</span><span class="na">setHttpOnly</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>  <span class="c1">// HttpOnly 설정</span>

            <span class="n">response</span><span class="o">.</span><span class="na">addCookie</span><span class="o">(</span><span class="n">cookie</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">response</span><span class="o">;</span>

        <span class="o">}).</span><span class="na">when</span><span class="o">(</span><span class="n">loginService</span><span class="o">).</span><span class="na">login</span><span class="o">(</span><span class="n">any</span><span class="o">(),</span> <span class="n">any</span><span class="o">(</span><span class="nc">HttpServletResponse</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>

        <span class="nc">MockHttpServletResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="s">"/api/v1/auth/login"</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">contentType</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="k">new</span> <span class="nc">ObjectMapper</span><span class="o">().</span><span class="na">writeValueAsString</span><span class="o">(</span><span class="n">request</span><span class="o">))</span>
                        <span class="o">.</span><span class="na">with</span><span class="o">(</span><span class="n">csrf</span><span class="o">()))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">())</span>
                <span class="o">.</span><span class="na">andDo</span><span class="o">(</span><span class="nc">MockMvcRestDocumentation</span><span class="o">.</span><span class="na">document</span><span class="o">(</span><span class="s">"login"</span><span class="o">,</span>
                        <span class="nc">ApiDocumentUtil</span><span class="o">.</span><span class="na">getDocumentRequest</span><span class="o">(),</span>
                        <span class="nc">ApiDocumentUtil</span><span class="o">.</span><span class="na">getDocumentResponse</span><span class="o">(),</span>
                        <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">requestFields</span><span class="o">(</span>
                                <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">fieldWithPath</span><span class="o">(</span><span class="s">"email"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"이메일"</span><span class="o">),</span>
                                <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">fieldWithPath</span><span class="o">(</span><span class="s">"password"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"영어, 숫자, 특수 문자 포함 8 - 20 자리 비밀번호"</span><span class="o">)</span>
                        <span class="o">),</span>
                        <span class="n">responseHeaders</span><span class="o">(</span>
                                <span class="n">headerWithName</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"Access token 을 포함한 헤더 입니다."</span><span class="o">),</span>
                                <span class="n">headerWithName</span><span class="o">(</span><span class="s">"Set-Cookie"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"Refresh token 을 포함한 헤더 입니다."</span><span class="o">)</span>
                        <span class="o">)))</span>
                <span class="o">.</span><span class="na">andReturn</span><span class="o">().</span><span class="na">getResponse</span><span class="o">();</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="n">fakeAccessToken</span><span class="o">,</span> <span class="n">response</span><span class="o">.</span><span class="na">getHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">));</span>
        <span class="n">assertTrue</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getCookies</span><span class="o">()[</span><span class="mi">0</span><span class="o">].</span><span class="na">getValue</span><span class="o">().</span><span class="na">contains</span><span class="o">(</span><span class="n">fakeRefreshToken</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>

</pre></td></tr></tbody></table></code></div></div>

<p><br />
<br /></p>

<h2 id="6-valid-로-값을-검증하는-경우"><span class="me-2">6. @Valid 로 값을 검증하는 경우</span><a href="#6-valid-로-값을-검증하는-경우" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h2>

<p>이미 존재하는 이메일을 가지고 회원가입을 하는 경우를 생각 해봅시다. (<em>이때 다른 요청 값은 다 패턴을 벗어나지 않는다고 가정합니다.</em>) 이 경우 @Valid 를 어긋나는 요청 값이 없기 때문에 서비스가 한번 수행될 것입니다.</p>

<div class="language-java highlighter-rouge"><div class="code-header" style="color: black !important;"">
        <span data-label-text="Java" style="color: black !important;"><img src="/assets/img/icons/code.png" width="21px" style="margin-right: 5px"/></span>
      <button aria-label="copy" data-title-succeed="Copied!"><img src="/assets/img/icons/copy.png" width="19px" style="margin-bottom: 4px"/></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="rouge-code"><pre><span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"존재 하는 이메일 검증"</span><span class="o">)</span>
    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">validateExistEmail</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">SignupRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SignupRequest</span><span class="o">(</span>
                <span class="s">"wldsmtldsm65@gmail.com"</span><span class="o">,</span>
                <span class="s">"123qwe!@#QWE"</span><span class="o">,</span>
                <span class="s">"시니"</span><span class="o">,</span>
                <span class="nc">LocalDate</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"1996-11-20"</span><span class="o">)</span>
        <span class="o">);</span>

        <span class="n">doThrow</span><span class="o">(</span><span class="k">new</span> <span class="nc">IllegalArgumentException</span><span class="o">())</span>
                <span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">signupService</span><span class="o">)</span>
                <span class="o">.</span><span class="na">signup</span><span class="o">(</span><span class="n">any</span><span class="o">(</span><span class="nc">SignupRequest</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>

        <span class="n">mockMvc</span>
                <span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="s">"/api/v1/auth/signup"</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">with</span><span class="o">(</span><span class="n">csrf</span><span class="o">())</span>
                        <span class="o">.</span><span class="na">contentType</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="n">objectMapper</span><span class="o">.</span><span class="na">writeValueAsString</span><span class="o">(</span><span class="n">request</span><span class="o">))</span>
                        <span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isBadRequest</span><span class="o">())</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">result</span> <span class="o">-&gt;</span> <span class="n">assertInstanceOf</span><span class="o">(</span><span class="nc">IllegalArgumentException</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">result</span><span class="o">.</span><span class="na">getResolvedException</span><span class="o">()))</span>
                <span class="o">.</span><span class="na">andDo</span><span class="o">(</span><span class="nc">MockMvcRestDocumentation</span><span class="o">.</span><span class="na">document</span><span class="o">(</span><span class="s">"signup-existent-email"</span><span class="o">,</span>
                        <span class="nc">ApiDocumentUtil</span><span class="o">.</span><span class="na">getDocumentRequest</span><span class="o">(),</span>
                        <span class="nc">ApiDocumentUtil</span><span class="o">.</span><span class="na">getDocumentResponse</span><span class="o">(),</span>
                        <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">requestFields</span><span class="o">(</span>
                                <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">fieldWithPath</span><span class="o">(</span><span class="s">"email"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"이메일"</span><span class="o">),</span>
                                <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">fieldWithPath</span><span class="o">(</span><span class="s">"password"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"영어, 숫자, 특수 문자 포함 8 - 20 자리 비밀번호"</span><span class="o">),</span>
                                <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">fieldWithPath</span><span class="o">(</span><span class="s">"nickname"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"특수 문자를 포함 하지 않는 2-12 자 닉네임"</span><span class="o">),</span>
                                <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">fieldWithPath</span><span class="o">(</span><span class="s">"birthday"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"생년월일"</span><span class="o">)</span>

                        <span class="o">)));</span>

        <span class="n">verify</span><span class="o">(</span><span class="n">signupService</span><span class="o">,</span> <span class="n">times</span><span class="o">(</span><span class="mi">1</span><span class="o">)).</span><span class="na">signup</span><span class="o">(</span><span class="n">any</span><span class="o">(</span><span class="nc">SignupRequest</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
    <span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>하지만 지정 해둔 패턴을 벗어나 @Valid 과정에서 <code>*MethodArgumentNotValidException</code>* 이 발생하는 경우는 어떻게 될까요? 서비스는 한번도 실행되지 못합니다. 예외가 발생하고 끝나버리죠. verify() 를 사용하여 테스트 코드를 검증할 때 이를 주의해주세요. 😉</p>

<div class="language-java highlighter-rouge"><div class="code-header" style="color: black !important;"">
        <span data-label-text="Java" style="color: black !important;"><img src="/assets/img/icons/code.png" width="21px" style="margin-right: 5px"/></span>
      <button aria-label="copy" data-title-succeed="Copied!"><img src="/assets/img/icons/copy.png" width="19px" style="margin-bottom: 4px"/></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre></td><td class="rouge-code"><pre><span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"닉네임 양식 검증"</span><span class="o">)</span>
    <span class="nd">@Test</span>
    <span class="c1">// a(길이 미달), 시니Aaaaaaaaaaaaaa(길이 초과), 시니😧(특수 문자 사용)</span>
    <span class="kt">void</span> <span class="nf">validateNickname</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">SignupRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SignupRequest</span><span class="o">(</span>
                <span class="s">"wldsmtldsm65@gmail.com"</span><span class="o">,</span>
                <span class="s">"123qwe!@#QWE"</span><span class="o">,</span>
                <span class="s">"[시니]"</span><span class="o">,</span> <span class="c1">// 특수 문자 사용</span>
                <span class="nc">LocalDate</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"1996-11-20"</span><span class="o">)</span>
        <span class="o">);</span>

        <span class="n">doNothing</span><span class="o">()</span>
                <span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">signupService</span><span class="o">)</span>
                <span class="o">.</span><span class="na">signup</span><span class="o">(</span><span class="n">any</span><span class="o">(</span><span class="nc">SignupRequest</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>

        <span class="n">mockMvc</span>
                <span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="s">"/api/v1/auth/signup"</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">with</span><span class="o">(</span><span class="n">csrf</span><span class="o">())</span>
                        <span class="o">.</span><span class="na">contentType</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="n">objectMapper</span><span class="o">.</span><span class="na">writeValueAsString</span><span class="o">(</span><span class="n">request</span><span class="o">))</span>
                        <span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isBadRequest</span><span class="o">())</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">result</span> <span class="o">-&gt;</span> <span class="n">assertInstanceOf</span><span class="o">(</span><span class="nc">MethodArgumentNotValidException</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">result</span><span class="o">.</span><span class="na">getResolvedException</span><span class="o">()))</span>
                <span class="o">.</span><span class="na">andDo</span><span class="o">(</span><span class="nc">MockMvcRestDocumentation</span><span class="o">.</span><span class="na">document</span><span class="o">(</span><span class="s">"signup-invalid-nickname"</span><span class="o">,</span>
                        <span class="nc">ApiDocumentUtil</span><span class="o">.</span><span class="na">getDocumentRequest</span><span class="o">(),</span>
                        <span class="nc">ApiDocumentUtil</span><span class="o">.</span><span class="na">getDocumentResponse</span><span class="o">(),</span>
                        <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">requestFields</span><span class="o">(</span>
                                <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">fieldWithPath</span><span class="o">(</span><span class="s">"email"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"이메일"</span><span class="o">),</span>
                                <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">fieldWithPath</span><span class="o">(</span><span class="s">"password"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"영어, 숫자, 특수 문자 포함 8 - 20 자리 비밀번호"</span><span class="o">),</span>
                                <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">fieldWithPath</span><span class="o">(</span><span class="s">"nickname"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"특수 문자를 포함 하지 않는 2-12 자 닉네임"</span><span class="o">),</span>
                                <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">fieldWithPath</span><span class="o">(</span><span class="s">"birthday"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"생년월일"</span><span class="o">)</span>

                        <span class="o">)));</span>

        <span class="n">verify</span><span class="o">(</span><span class="n">signupService</span><span class="o">,</span> <span class="n">never</span><span class="o">()).</span><span class="na">signup</span><span class="o">(</span><span class="n">any</span><span class="o">(</span><span class="nc">SignupRequest</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
    <span class="o">}</span>

</pre></td></tr></tbody></table></code></div></div>

<p><br />
<br /></p>

<h2 id="7-특정-예외가-잘-나오는지-확인하고-싶다면-"><span class="me-2">7. 특정 예외가 잘 나오는지 확인하고 싶다면? 🤔</span><a href="#7-특정-예외가-잘-나오는지-확인하고-싶다면-" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h2>

<h3 id="71-원하는-예외는-어디에-위치하는가"><span class="me-2">7.1. 원하는 예외는 어디에 위치하는가?</span><a href="#71-원하는-예외는-어디에-위치하는가" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h3>

<p>이전에  <a href="./2023-08-31-exception-custom-by-filter.md">Filter 에 따른 Exception Custom - EntryPoint 란?</a> 글을 작성한 적이 있습니다. 예외가 어디서 발생 하는지에 따라 처리를 하는 방식이 다릅니다. 간단하게 말하면, 시큐리티 필터를 넘어가기 전가지의 오류는 AuthenticationEntryPoint 를 사용하여, 그 이후 서비스 로직 등에서 나타난 오류는 @<em>ControllerAdvice</em> 와 @<em>ExceptionHandler</em> 를 사용하여 처리합니다. 저는 여기서 인증 예외에 관한 이야기를 더 해보고자 합니다.</p>

<h3 id="72-webmvctest-가-가져오는-security-configuration-은-️"><span class="me-2">7.2. @WebMvcTest 가 가져오는 Security Configuration 은… 🤦🏻‍♀️</span><a href="#72-webmvctest-가-가져오는-security-configuration-은-️" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h3>

<p>제목 그대로 @WebMvcTest 가 가져오는 Security Configuration 은 기본 설정 입니다. 따라서 테스트 실행시 아래와 같은 문구를 확인할 수 있죠.</p>

<pre><code>2024-04-21T18:42:53.552+09:00 DEBUG 7992 --- [           main] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2024-04-21T18:42:53.554+09:00 DEBUG 7992 --- [           main] s.w.a.DelegatingAuthenticationEntryPoint : Trying to match using And [Not [RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]], MediaTypeRequestMatcher [contentNegotiationStrategy=org.springframework.web.accept.ContentNegotiationManager@75eaba95, matchingMediaTypes=[application/xhtml+xml, image/*, text/html, text/plain], useEquals=false, ignoredMediaTypes=[*/*]]]
2024-04-21T18:42:53.554+09:00 DEBUG 7992 --- [           main] s.w.a.DelegatingAuthenticationEntryPoint : Trying to match using Or [RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest], And [Not [MediaTypeRequestMatcher [contentNegotiationStrategy=org.springframework.web.accept.ContentNegotiationManager@75eaba95, matchingMediaTypes=[text/html], useEquals=false, ignoredMediaTypes=[]]], MediaTypeRequestMatcher [contentNegotiationStrategy=org.springframework.web.accept.ContentNegotiationManager@75eaba95, matchingMediaTypes=[application/atom+xml, application/x-www-form-urlencoded, application/json, application/octet-stream, application/xml, multipart/form-data, text/xml], useEquals=false, ignoredMediaTypes=[*/*]]], MediaTypeRequestMatcher [contentNegotiationStrategy=org.springframework.web.accept.ContentNegotiationManager@75eaba95, matchingMediaTypes=[*/*], useEquals=true, ignoredMediaTypes=[]]]
2024-04-21T18:42:53.555+09:00 DEBUG 7992 --- [           main] s.w.a.DelegatingAuthenticationEntryPoint : Match found! Executing org.springframework.security.web.authentication.DelegatingAuthenticationEntryPoint@34ab26a
2024-04-21T18:42:53.555+09:00 DEBUG 7992 --- [           main] s.w.a.DelegatingAuthenticationEntryPoint : Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2024-04-21T18:42:53.555+09:00 DEBUG 7992 --- [           main] s.w.a.DelegatingAuthenticationEntryPoint : **No match found. Using default entry point** org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@5891b7c5
</code></pre>

<p>제가 설정한 AuthenticationEntryPoint 를 찾지 못해 기본 AuthenticationEntryPoint 를 쓰겠다는 소리 입니다. 이는 당연한게 커스텀한 AuthenticationEntryPoint 는 제가 따로 생성한 Security configuration 에 등록하는데, 가져오는 configuration 자체가 기본 설정이기 때문이죠.</p>

<h3 id="73-usernamenotfoundexception"><span class="me-2">7.3. UsernameNotFoundException()</span><a href="#73-usernamenotfoundexception" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h3>

<p>존재하지 않는 이메일로 로그인을 시도했을 때 기본적으로 401 코드를 반환합니다. 하지만 저는 조금 더 명확함을 원해 404 코드를 반환하도록 아래와 같이 작성했습니다.</p>

<div class="language-java highlighter-rouge"><div class="code-header" style="color: black !important;"">
        <span data-label-text="Java" style="color: black !important;"><img src="/assets/img/icons/code.png" width="21px" style="margin-right: 5px"/></span>
      <button aria-label="copy" data-title-succeed="Copied!"><img src="/assets/img/icons/copy.png" width="19px" style="margin-bottom: 4px"/></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="nd">@Component</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomAuthenticationEntryPoint</span> <span class="kd">implements</span> <span class="nc">AuthenticationEntryPoint</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">commence</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="nc">AuthenticationException</span> <span class="n">authException</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">authException</span> <span class="k">instanceof</span> <span class="nc">UsernameNotFoundException</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">response</span><span class="o">.</span><span class="na">setStatus</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">NOT_FOUND</span><span class="o">.</span><span class="na">value</span><span class="o">());</span>
            <span class="n">setResponse</span><span class="o">(</span><span class="n">response</span><span class="o">,</span> <span class="s">"AUTH_01"</span><span class="o">);</span>
</pre></td></tr></tbody></table></code></div></div>

<p>하지만 테스트 수행결과 아래와 같은 결과가 나왔죠.</p>

<div class="language-console highlighter-rouge"><div class="code-header" style="color: black !important;"">
        <span data-label-text="Console" style="color: black !important;"><img src="/assets/img/icons/code.png" width="21px" style="margin-right: 5px"/></span>
      <button aria-label="copy" data-title-succeed="Copied!"><img src="/assets/img/icons/copy.png" width="19px" style="margin-bottom: 4px"/></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="go">MockHttpServletResponse:
           Status = 401
    Error message = Unauthorized
          Headers = [Vary:"Origin", "Access-Control-Request-Method", "Access-Control-Request-Headers", WWW-Authenticate:"Basic realm="Realm"", X-Content-Type-Options:"nosniff", X-XSS-Protection:"0", Cache-Control:"no-cache, no-store, max-age=0, must-revalidate", Pragma:"no-cache", Expires:"0", X-Frame-Options:"DENY"]
     Content type = null
             Body = 
    Forwarded URL = null
   Redirected URL = null
          Cookies = []
</span></pre></td></tr></tbody></table></code></div></div>

<p>그렇다면 실제 환경에서는 어떨까 테스트를 해보았습니다. 그리고 원하는 결과가 잘 나오는 것을 확인할 수 있었습니다.</p>

<div class="language-http highlighter-rouge"><div class="code-header" style="color: black !important;"">
        <span data-label-text="Http" style="color: black !important;"><img src="/assets/img/icons/code.png" width="21px" style="margin-right: 5px"/></span>
      <button aria-label="copy" data-title-succeed="Copied!"><img src="/assets/img/icons/copy.png" width="19px" style="margin-bottom: 4px"/></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">400</span> 
<span class="na">Vary</span><span class="p">:</span> <span class="s">Origin</span>
<span class="na">Vary</span><span class="p">:</span> <span class="s">Access-Control-Request-Method</span>
<span class="na">Vary</span><span class="p">:</span> <span class="s">Access-Control-Request-Headers</span>
<span class="na">X-Content-Type-Options</span><span class="p">:</span> <span class="s">nosniff</span>
<span class="na">X-XSS-Protection</span><span class="p">:</span> <span class="s">0</span>
<span class="na">Cache-Control</span><span class="p">:</span> <span class="s">no-cache, no-store, max-age=0, must-revalidate</span>
<span class="na">Pragma</span><span class="p">:</span> <span class="s">no-cache</span>
<span class="na">Expires</span><span class="p">:</span> <span class="s">0</span>
<span class="na">X-Frame-Options</span><span class="p">:</span> <span class="s">DENY</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json;charset=UTF-8</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">26</span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Sun, 21 Apr 2024 09:59:15 GMT</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>

<span class="p">{</span><span class="w">
  </span><span class="nl">"errorCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AUTH_02"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h3 id="74-springboottest-의-사용"><span class="me-2">7.4. @SpringBootTest 의 사용</span><a href="#74-springboottest-의-사용" class="anchor text-muted" style="text-decoration-line: none !important;" >
           <img src="/assets/img/icons/mouse.png" width="18px" style="margin-bottom: 3px !important;"/>
      </a></h3>

<p><strong>이미 존재</strong> 하는 유저와의 값을 비교해야 하기도 하고, 시큐리티 설정등 최대한 운영 환경과 비슷한 환경에서 테스트를 하기 위해 @SpringBootTest 를 사용하기로 결정하였습니다. static 폴더 아래 테스트 전용 yml 을 생성해주었습니다.</p>

<p>src/test/resources 디렉토리에 application.yml 을 넣어주면 테스트 실행 시 자동으로 로드되며, 기본 application.yml 보다 우선적으로 적용이 됩니다. 저의 경우 test database 의 경우 H2 를 사용하였습니다. (<em>나중에 1차 개발이 완료되면 데이터 서버를 팔 계획 입니다.</em>)</p>

<div class="language-yml highlighter-rouge"><div class="code-header" style="color: black !important;"">
        <span data-label-text="YAML" style="color: black !important;"><img src="/assets/img/icons/code.png" width="21px" style="margin-right: 5px"/></span>
      <button aria-label="copy" data-title-succeed="Copied!"><img src="/assets/img/icons/copy.png" width="19px" style="margin-bottom: 4px"/></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre></td><td class="rouge-code"><pre><span class="na">spring</span><span class="pi">:</span>
  <span class="na">main</span><span class="pi">:</span>
    <span class="na">allow-bean-definition-overriding</span><span class="pi">:</span> <span class="kc">true</span>

  <span class="na">jpa</span><span class="pi">:</span>
    <span class="na">database-platform</span><span class="pi">:</span> <span class="s">org.hibernate.dialect.H2Dialect</span>
    <span class="na">show-sql</span><span class="pi">:</span> <span class="kc">true</span>
    <span class="na">hibernate</span><span class="pi">:</span>
      <span class="na">ddl-auto</span><span class="pi">:</span> <span class="s">update</span>

  <span class="na">datasource</span><span class="pi">:</span>
    <span class="na">url</span><span class="pi">:</span> <span class="s">jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE</span>
    <span class="na">driverClassName</span><span class="pi">:</span> <span class="s">org.h2.Driver</span>
    <span class="na">username</span><span class="pi">:</span> <span class="s">sa</span>
    <span class="na">password</span><span class="pi">:</span>

  <span class="na">data</span><span class="pi">:</span>
    <span class="na">redis</span><span class="pi">:</span>
      <span class="na">port</span><span class="pi">:</span> <span class="m">6379</span>
      <span class="na">host</span><span class="pi">:</span> <span class="s">127.0.0.1</span>

  <span class="na">springdoc</span><span class="pi">:</span>
    <span class="na">version</span><span class="pi">:</span> <span class="s">v1.0.0</span>
    <span class="na">default-consumes-media-type</span><span class="pi">:</span> <span class="s">application/json;charset=UTF-8</span>

  <span class="na">secret</span><span class="pi">:</span>
    <span class="na">key</span><span class="pi">:</span> <span class="s">${SECRET}</span>

  <span class="na">servlet</span><span class="pi">:</span>
    <span class="na">multipart</span><span class="pi">:</span>
      <span class="na">max-file-size</span><span class="pi">:</span> <span class="s">10MB</span>
      <span class="na">max-request-size</span><span class="pi">:</span> <span class="s">10MB</span>

<span class="na">logging</span><span class="pi">:</span>
  <span class="na">level</span><span class="pi">:</span>
    <span class="na">root</span><span class="pi">:</span>
      <span class="s">info</span>

    <span class="na">org</span><span class="pi">:</span>
      <span class="na">springframework</span><span class="pi">:</span>
        <span class="na">security</span><span class="pi">:</span>
          <span class="s">debug</span>

        <span class="na">jdbc</span><span class="pi">:</span>
          <span class="na">core</span><span class="pi">:</span>
            <span class="s">debug</span>

    <span class="na">web</span><span class="pi">:</span>
      <span class="s">debug</span>
</pre></td></tr></tbody></table></code></div></div>

<p>공개 되어서는 안되는 key 의 경우 환경 변수로 설정하여 따로 관리해주세요. 해당 변수는 test configuration 설정 시 넣어주면 됩니다.</p>

<p><a href="/assets/post/post-img36.png" class="popup img-link  shimmer"><img src="/assets/post/post-img36.png" width="800px" loading="lazy"></a></p>

<p>그후 아래와 같이 코드를 작성하고 실행하면 테스트에 성공함을 알 수 있습니다.</p>

<p><a href="/assets/post/post-img35.png" class="popup img-link  shimmer"><img src="/assets/post/post-img35.png" width="300px" loading="lazy"></a></p>

<div class="language-java highlighter-rouge"><div class="code-header" style="color: black !important;"">
        <span data-label-text="Java" style="color: black !important;"><img src="/assets/img/icons/code.png" width="21px" style="margin-right: 5px"/></span>
      <button aria-label="copy" data-title-succeed="Copied!"><img src="/assets/img/icons/copy.png" width="19px" style="margin-bottom: 4px"/></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
</pre></td><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.planner.travel.user.login</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.ObjectMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.planner.travel.domain.user.dto.request.LoginRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.planner.travel.domain.user.entity.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.planner.travel.domain.user.repository.UserRepository</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.planner.travel.domain.user.service.LoginService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.planner.travel.global.ApiDocumentUtil</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.BeforeEach</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DisplayName</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.test.autoconfigure.restdocs.AutoConfigureRestDocs</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.test.context.SpringBootTest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.MediaType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.restdocs.mockmvc.MockMvcRestDocumentation</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.restdocs.payload.PayloadDocumentation</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.test.web.servlet.MockMvc</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.test.web.servlet.request.MockMvcRequestBuilders</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.test.web.servlet.result.MockMvcResultMatchers</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.time.LocalDate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.LocalDateTime</span><span class="o">;</span>

<span class="nd">@SpringBootTest</span>
<span class="nd">@AutoConfigureMockMvc</span>
<span class="nd">@AutoConfigureRestDocs</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LoginAuthenticationTest</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="nc">MockMvc</span> <span class="n">mockMvc</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="nc">LoginService</span> <span class="n">loginService</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">ObjectMapper</span> <span class="n">objectMapper</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">;</span>

    <span class="nd">@BeforeEach</span>
    <span class="kt">void</span> <span class="nf">setUp</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">userRepository</span><span class="o">.</span><span class="na">deleteAll</span><span class="o">();</span>

        <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="nc">User</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">email</span><span class="o">(</span><span class="s">"wldsmtldsm65@gmail.com"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">password</span><span class="o">(</span><span class="s">"123qwe!#QWE"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">nickname</span><span class="o">(</span><span class="s">"시은"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">isWithdrawal</span><span class="o">(</span><span class="kc">false</span><span class="o">)</span>
                <span class="o">.</span><span class="na">birthday</span><span class="o">(</span><span class="nc">LocalDate</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"1996-11-20"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">signupDate</span><span class="o">(</span><span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">())</span>
                <span class="o">.</span><span class="na">userTag</span><span class="o">(</span><span class="mi">1234L</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>

        <span class="n">userRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"존재 하지 않는 이메일을 입력한 경우"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">loginWithWrongEmail</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">LoginRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LoginRequest</span><span class="o">(</span>
                <span class="s">"suminnnn@gmail.com"</span><span class="o">,</span>
                <span class="s">"123qwe!@#QWE"</span>
        <span class="o">);</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="nc">MockMvcRequestBuilders</span><span class="o">.</span><span class="na">post</span><span class="o">(</span><span class="s">"/api/v1/auth/login"</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">contentType</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="n">objectMapper</span><span class="o">.</span><span class="na">writeValueAsString</span><span class="o">(</span><span class="n">request</span><span class="o">)))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="nc">MockMvcResultMatchers</span><span class="o">.</span><span class="na">status</span><span class="o">().</span><span class="na">isNotFound</span><span class="o">())</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="nc">MockMvcResultMatchers</span><span class="o">.</span><span class="na">jsonPath</span><span class="o">(</span><span class="s">"$.errorCode"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="s">"AUTH_01"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andDo</span><span class="o">(</span><span class="nc">MockMvcRestDocumentation</span><span class="o">.</span><span class="na">document</span><span class="o">(</span><span class="s">"login-notexistent-email"</span><span class="o">,</span>
                        <span class="nc">ApiDocumentUtil</span><span class="o">.</span><span class="na">getDocumentRequest</span><span class="o">(),</span>
                        <span class="nc">ApiDocumentUtil</span><span class="o">.</span><span class="na">getDocumentResponse</span><span class="o">(),</span>
                        <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">requestFields</span><span class="o">(</span>
                                <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">fieldWithPath</span><span class="o">(</span><span class="s">"email"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"이메일"</span><span class="o">),</span>
                                <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">fieldWithPath</span><span class="o">(</span><span class="s">"password"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"영어, 숫자, 특수 문자 포함 8 - 20 자리 비밀번호"</span><span class="o">)</span>
                        <span class="o">)</span>
                <span class="o">));</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"잘못된 비밀번호를 입력하여 로그인"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">loginWithWrongPassword</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">LoginRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LoginRequest</span><span class="o">(</span>
                <span class="s">"wldsmtldsm65@gmail.com"</span><span class="o">,</span>
                <span class="s">"123qwe!@#QWE1"</span>
        <span class="o">);</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="nc">MockMvcRequestBuilders</span><span class="o">.</span><span class="na">post</span><span class="o">(</span><span class="s">"/api/v1/auth/login"</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">contentType</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="n">objectMapper</span><span class="o">.</span><span class="na">writeValueAsString</span><span class="o">(</span><span class="n">request</span><span class="o">)))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="nc">MockMvcResultMatchers</span><span class="o">.</span><span class="na">status</span><span class="o">().</span><span class="na">isBadRequest</span><span class="o">())</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="nc">MockMvcResultMatchers</span><span class="o">.</span><span class="na">jsonPath</span><span class="o">(</span><span class="s">"$.errorCode"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="s">"AUTH_02"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andDo</span><span class="o">(</span><span class="nc">MockMvcRestDocumentation</span><span class="o">.</span><span class="na">document</span><span class="o">(</span><span class="s">"login-wrong-password"</span><span class="o">,</span>
                        <span class="nc">ApiDocumentUtil</span><span class="o">.</span><span class="na">getDocumentRequest</span><span class="o">(),</span>
                        <span class="nc">ApiDocumentUtil</span><span class="o">.</span><span class="na">getDocumentResponse</span><span class="o">(),</span>
                        <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">requestFields</span><span class="o">(</span>
                                <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">fieldWithPath</span><span class="o">(</span><span class="s">"email"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"이메일"</span><span class="o">),</span>
                                <span class="nc">PayloadDocumentation</span><span class="o">.</span><span class="na">fieldWithPath</span><span class="o">(</span><span class="s">"password"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"영어, 숫자, 특수 문자 포함 8 - 20 자리 비밀번호"</span><span class="o">)</span>
                        <span class="o">)</span>
                <span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta">
        <a href="https://sieunnnn.github.io/assets/img/icons/openFolder.png" class="popup img-link  shimmer"><img src="https://sieunnnn.github.io/assets/img/icons/openFolder.png" width="17px" style="text-decoration-line: none !important; margin: 2px 11px 0 3px; height:17px !important;" loading="lazy"></a>
        
          <a href="/categories/spring-boot/" style="text-decoration-line: none !important; margin-top: 2px">Spring boot</a>,
          <a href="/categories/test/" style="text-decoration-line: none !important; margin-top: 2px">Test</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags" style="margin-top: 6px">
        <a href="https://sieunnnn.github.io/assets/img/icons/tags.png" class="popup img-link  shimmer"><img src="https://sieunnnn.github.io/assets/img/icons/tags.png" width="19px" style="text-decoration-line: none !important; margin: 2px 10px 0 2px; height:19px !important;" loading="lazy"></a>
        
          <a
            href="/tags/test/"
            class="post-tag no-text-decoration"
          >test</a>
        
          <a
            href="/tags/%ED%98%91%EC%97%85/"
            class="post-tag no-text-decoration"
          >협업</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>
    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/2023-09-17-send-find-password-mail/"></a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/2024-04-18-setter-builder-jackson/"></a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/deploy-project-free-using-vercel-and-ngrok/">vercel, ngrok 을 사용하여 무료로 프로젝트 배포하기</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/map-service-using-google-map-api/">google map api 를 사용한 지도 검색과 지도 생성</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/lazy-initialization-exception/">LazyInitializationException 과 SecurityContextHolder</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag" href="/tags/exception/">exception</a>
      
        
        <a class="post-tag" href="/tags/github-actions/">github actions</a>
      
        
        <a class="post-tag" href="/tags/security/">security</a>
      
        
        <a class="post-tag" href="/tags/%EC%9E%90%EB%8F%99%EB%B0%B0%ED%8F%AC/">자동배포</a>
      
        
        <a class="post-tag" href="/tags/docker/">docker</a>
      
        
        <a class="post-tag" href="/tags/stomp/">stomp</a>
      
        
        <a class="post-tag" href="/tags/websocket/">websocket</a>
      
        
        <a class="post-tag" href="/tags/%ED%98%91%EC%97%85/">협업</a>
      
        
        <a class="post-tag" href="/tags/jwt/">JWT</a>
      
        
        <a class="post-tag" href="/tags/spring-boot-3/">spring boot 3</a>
      
    </div>
  </section>


            </div>

            
              
              


  
    
      
        
  
        
        
      





  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/cooperation-with-front-team-using-docker/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1713411180"
  data-df="ll"
  
>
  Apr 18, 2024
</time>

              <h4 class="pt-0 my-2">Docker 를 사용하여 front 팀과 협업하기</h4>
              <div class="text-muted">
                <p>운영도 안하는데 돈을 쓰는건 너무 아깝잖아요. docker 를 사용해봅시다.</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/cooperation-with-backend-team-using-docker/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1713411180"
  data-df="ll"
  
>
  Apr 18, 2024
</time>

              <h4 class="pt-0 my-2">Docker 를 사용하여 backend 팀과 협업하기</h4>
              <div class="text-muted">
                <p>프로젝트가 처음인 팀원의 환경 구축시간을 줄이고, 공통된 환경을 만들고 싶다면 docker 를 사용해보세요.</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/lazy-initialization-exception/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1700451180"
  data-df="ll"
  
>
  Nov 20, 2023
</time>

              <h4 class="pt-0 my-2">LazyInitializationException 과 SecurityContextHolder</h4>
              <div class="text-muted">
                <p>누구나 한번쯤은 본다는 LazyInitializationException 🫠</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/record-and-dto/"
      class="btn"
      aria-label="Older"
    >
      <p>Record 와 DTO</p>
    </a>
  

  
    <a
      href="/posts/watch-out-when-using-github-actions/"
      class="btn"
      aria-label="Newer"
    >
      <p>Github Actions 를 사용하여 Image build, push 자동화 시 유의해야 할 보안 문제</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://github.com/sieunnnn">김자바</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.2.4"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag" href="/tags/exception/">exception</a>
      
        
        <a class="post-tag" href="/tags/github-actions/">github actions</a>
      
        
        <a class="post-tag" href="/tags/security/">security</a>
      
        
        <a class="post-tag" href="/tags/%EC%9E%90%EB%8F%99%EB%B0%B0%ED%8F%AC/">자동배포</a>
      
        
        <a class="post-tag" href="/tags/docker/">docker</a>
      
        
        <a class="post-tag" href="/tags/stomp/">stomp</a>
      
        
        <a class="post-tag" href="/tags/websocket/">websocket</a>
      
        
        <a class="post-tag" href="/tags/%ED%98%91%EC%97%85/">협업</a>
      
        
        <a class="post-tag" href="/tags/jwt/">JWT</a>
      
        
        <a class="post-tag" href="/tags/spring-boot-3/">spring boot 3</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

